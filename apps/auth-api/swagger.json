{
    "openapi": "3.1.0",
    "info": {
        "description": "Authorization API for STEXS",
        "title": "Authorization API",
        "version": "1.0.0"
    },
    "host": "localhost",
    "basePath": "/auth/api/v1/",
    "consumes": [
        "application/json"
    ],
    "produces": [
        "application/json"
    ],
    "components": {
        "schemas": {
            "AccessTokenResponse": {
                "type": "object",
                "properties": {
                    "access_token": {
                        "type": "string",
                        "format": "JWT",
                        "description": "A token that grants access to the user's resources."
                    },
                    "refresh_token": {
                        "type": "string",
                        "format": "JWT",
                        "description": "A token used to request a new access token without requiring the user's identifier and password."
                    },
                    "token_type": {
                        "type": "string",
                        "description": "The type of the access token (e.g., 'bearer')."
                    },
                    "expires": {
                        "type": "integer",
                        "format": "UNIX",
                        "description": "The expiration timestamp of the access token."
                    }
                },
                "example": {
                    "access_token": "jwt-token",
                    "refresh_token": "jwt-token",
                    "token_type": "bearer",
                    "expires": 1696457106
                }
            },
            "SuccessResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "A boolean indicator of the operation's success."
                    },
                    "message": {
                        "type": "string",
                        "description": "A human-readable message describing the result of the operation."
                    },
                    "timestamp": {
                        "type": "string",
                        "format":"ISO 8601",
                        "description": "The timestamp when the message was generated."
                    },
                    "data": {
                        "type": "object",
                        "description": "Additional relevant data returned with the response."
                    }
                },
                "example": {
                    "success": true,
                    "message": "Success message",
                    "timestamp": "2023-10-05T14:21:52.793Z",
                    "data": {}
                }
            }
        },
        "securitySchemes": {
            "Auth": {
                "type": "apiKey",
                "in": "header",
                "name": "Authorization",
                "description": "Bearer Token"
            }
        }
    },
    "paths": {
        "/": {
            "get": {
                "tags": [
                    "Introspection"
                ],
                "summary": "Retrieve the OpenAPI Description (This Document)",
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Request Successful"
                    }
                }
            }
        },
        "/sign-in": {
            "post": {
                "summary": "Sign In or Initialize Sign-In",
                "description": "Allows users to sign in or initialize the sign-in process.",
                "tags": [
                    "Sign In"
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "identifier": {
                                        "type": "string",
                                        "description": "The email address or username associated with the account."
                                    },
                                    "password": {
                                        "type": "string",
                                        "description": "The password used for authentication and account access."
                                    }
                                },
                                "required": [
                                    "identifier",
                                    "password"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successfully signed in or sign-in process initialized.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "oneOf": [
                                        {
                                            "type": "object",
                                            "properties": {
                                                "token": {
                                                    "type": "string",
                                                    "format": "JWT",
                                                    "description": "A JSON Web Token (JWT) used to confirm the sign-in."
                                                },
                                                "types": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string"
                                                    },
                                                    "description": "An array of supported Multi-Factor Authentication (MFA) types for the account."
                                                },
                                                "expires": {
                                                    "type": "integer",
                                                    "format": "UNIX",
                                                    "description": "The timestamp indicating the expiration time of the sign-in confirmation token."
                                                }
                                            }
                                        },
                                        {
                                            "$ref": "#/components/schemas/AccessTokenResponse"
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/sign-in/confirm": {
            "post": {
                "summary": "Confirm Sign-In with Multi-Factor Authentication (MFA)",
                "description": "Confirms the user's sign-in using Multi-Factor Authentication (MFA) methods.",
                "tags": ["Sign In"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "code": {
                                        "type": "string",
                                        "description": "A confirmation code that depends on the chosen Multi-Factor Authentication (MFA) type."
                                    },
                                    "type": {
                                        "type": "string",
                                        "description": "The Multi-Factor Authentication (MFA) type supported by the account."
                                    },
                                    "token": {
                                        "type": "string",
                                        "format": "JWT",
                                        "description": "A JSON Web Token (JWT) used for confirming the sign-in from the /sign-in endpoint."
                                    }
                                },
                                "required": [
                                    "code",
                                    "type",
                                    "token"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successfully signed in with Multi-Factor Authentication (MFA).",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AccessTokenResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/sign-out": {
            "post": {
                "summary": "Sign Out from the Current Session",
                "description": "Logs the user out from the current session.",
                "tags": ["Sign Out"],
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Successfully signed out from the current session"
                    }
                }
            }
        },
        "/sign-out/everywhere": {
            "post": {
                "summary": "Sign Out from All Sessions",
                "description": "Logs the user out from all active sessions.",
                "tags": ["Sign Out"],
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Successfully signed out from all sessions"
                    }
                }
            }
        },
        "/sign-up": {
            "post": {
                "summary": "Create a New Account",
                "tags": ["Sign Up"],
                "description": "Register a new user account with the following required information.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "username": {
                                        "type": "string",
                                        "description": "A unique username for the user, consisting of 1 to 20 Latin characters, and should not resemble an email address."
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "description": "The user's email address. Must be a valid email format (e.g., 'user@example.com')."
                                    },
                                    "password": {
                                        "type": "string",
                                        "description": "A secure password that must meet the following criteria: - At least 10 characters long - Contains at least one uppercase letter - Contains at least one lowercase letter - Contains at least one special character - Contains at least one number"
                                    }
                                },
                                "required": [
                                    "username",
                                    "email",
                                    "password"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Account Successfully Created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/verify": {
            "post": {
                "summary": "Verify Email Address",
                "tags": ["Verify Email"],
                "description": "Allows users to verify their email address after signing up. This endpoint is used to confirm the validity of the provided email address and activate the user's account.",
                "parameters": [
                    {
                        "name": "email",
                        "format": "email",
                        "in": "query",
                        "description": "The email address to be verified.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "token",
                        "in": "query",
                        "description": "The verification token sent to the user's email address.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "302": {
                        "description": "Redirect to Sign In",
                        "headers": {
                            "Location": {
                                "description": "The URL to redirect to for sign-in with verification status.",
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/verify/resend": {
            "post": {
                "summary": "Request Resend of Verification Email",
                "tags": ["Verify Email"],
                "description": "Allows users to request the resend of a verification email. Use this endpoint to send another email verification link to the user's registered email address in case the original verification email was not received or expired.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "description": "The user's registered email address for which the verification email should be resent."
                                    }
                                },
                                "required": ["email"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Verification Email Requested",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/token": {
            "post": {
                "summary": "Refresh Access Token",
                "tags": ["Token"],
                "description": "Allows users to refresh their access token by exchanging a valid refresh token. Use this endpoint to obtain a new access token and refresh token pair, which can be used to continue accessing protected resources without the need for reauthentication.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "refresh_token": {
                                        "type": "string",
                                        "format": "JWT",
                                        "description": "The user's valid refresh token to exchange for a new pair of access and refresh tokens."
                                    }
                                },
                                "required": ["refresh_token"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Token Refresh Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AccessTokenResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/recovery": {
            "post": {
                "summary": "Initiate Password Recovery",
                "tags": ["Recovery"],
                "description": "Allows users to initiate the process of recovering their password. Use this endpoint to request a password reset link sent to the user's registered email address. This link will enable the user to create a new password.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "description": "The user's registered email address for initiating password recovery."
                                    }
                                },
                                "required": ["email"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Password Recovery Requested",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref":"#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/recovery/confirm": {
            "post": {
                "summary": "Confirm Password Recovery",
                "tags": ["Recovery"],
                "description": "Allows users to confirm and complete the password recovery process. Use this endpoint to validate the email, token, and set a new password for the user's account.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "description": "The user's registered email address associated with the password recovery process."
                                    },
                                    "token": {
                                        "type": "string",
                                        "format": "UUID",
                                        "description": "The unique token provided in the password recovery email."
                                    },
                                    "password": {
                                        "type": "string",
                                        "description": "The new password to be set for the user's account."
                                    }
                                },
                                "required": [
                                    "email",
                                    "token",
                                    "password"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Password Recovery Confirmed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref":"#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/user": {
            "get": {
                "summary": "Retrieve User Data",
                "tags": ["User"],
                "description": "Allows authenticated users to retrieve their own user data. This endpoint provides access to essential user information, including email, raw user metadata, creation timestamp, update timestamp, and user ID.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User Data Retrieved",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "id": {
                                            "type": "string",
                                            "format": "UUID",
                                            "description": "A unique UUID identifier for the user's account."
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email",
                                            "description": "The user's registered email address."
                                        },
                                        "raw_user_meta_data": {
                                            "type": "object",
                                            "description": "Raw user metadata associated with the user's account."
                                        },
                                        "created_at": {
                                            "type": "string",
                                            "format": "ISO 8601",
                                            "description": "Timestamp indicating when the user's account was created."
                                        },
                                        "updated_at": {
                                            "type": "string",
                                            "format": "ISO 8601",
                                            "description": "Timestamp indicating when the user's account was last updated."
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/user/password": {
            "post": {
                "summary": "Change Password",
                "tags": ["User"],
                "description": "Allows authenticated users to change their account password. Use this endpoint to securely update the user's password.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "password": {
                                        "type": "string",
                                        "description": "The new password to be set for the user's account."
                                    }
                                },
                                "required": ["password"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Password Change Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/user/email": {
            "post": {
                "summary": "Initialize Email Change",
                "tags": ["User"],
                "description": "Allows authenticated users to initialize a change to their registered email address. Use this endpoint to start the process of updating the email associated with the user's account.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "description": "The new email address to be associated with the user's account."
                                    }
                                },
                                "required": ["email"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Email Change Initialization Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/user/email/verify": {
            "post": {
                "summary": "Verify Email Change",
                "tags": ["User"],
                "description": "Allows authenticated users to verify their email change by providing the verification code sent to their new email address. Use this endpoint to confirm the change of the email associated with the user's account.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "code": {
                                        "type": "string",
                                        "description": "The verification code sent to the user's new email address for email change confirmation."
                                    }
                                },
                                "required": ["code"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Email Change Verification Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/mfa": {
            "get": {
                "summary": "Check MFA Status",
                "tags": ["Multi-Factor Authentication (MFA)"],
                "description": "Allows authenticated users to check the status of their Multi-Factor Authentication (MFA) flows. This endpoint provides information on whether MFA methods like email and TOTP (Time-Based One-Time Password) are enabled or disabled for the user's account.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "MFA Status Retrieval Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "email": {
                                            "type": "boolean",
                                            "description": "Indicates whether email-based MFA is enabled for the user's account."
                                        },
                                        "totp": {
                                            "type": "boolean",
                                            "description": "Indicates whether TOTP (Time-Based One-Time Password) MFA is enabled for the user's account."
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/mfa/enable": {
            "post": {
                "summary": "Enable Multi-Factor Authentication (MFA)",
                "tags": ["Multi-Factor Authentication (MFA)"],
                "description": "Allows users to enable Multi-Factor Authentication (MFA) for enhanced account security.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "type": {
                                        "type": "string",
                                        "enum": ["email", "totp"],
                                        "description": "The type of MFA method to enable (email or TOTP)."
                                    },
                                    "code": {
                                        "type": "string",
                                        "description": "The confirmation code for enabling the 'email' MFA method. Required only for the 'email' method."
                                    }
                                },
                                "required": ["type"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Email MFA Enable Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    },
                    "200 TOTP": {
                        "description": "TOTP Initialization Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "secret": {
                                            "type": "string",
                                            "description": "The secret key for generating Time-Based One-Time Passwords (TOTP). Store this secret securely."
                                        },
                                        "otp_auth_uri": {
                                            "type": "string",
                                            "description": "A URI that can be used to configure authenticator apps (e.g., Google Authenticator) for TOTP. This URI includes the secret key and other necessary information."
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/mfa/disable": {
            "post": {
                "summary": "Disable Multi-Factor Authentication (MFA)",
                "tags": ["Multi-Factor Authentication (MFA)"],
                "description": "Allows users to disable Multi-Factor Authentication (MFA) for their account.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "type": {
                                        "type": "string",
                                        "enum": ["email", "totp"],
                                        "description": "The type of MFA method to disable (email or TOTP)."
                                    },
                                    "code": {
                                        "type": "string",
                                        "description": "The confirmation code for disabling the selected MFA method. The code should be specific to the chosen type (email or TOTP)."
                                    }
                                },
                                "required": ["type", "code"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "MFA Disable Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/mfa/verify": {
            "post": {
                "summary": "Verify MFA",
                "tags": ["Multi-Factor Authentication (MFA)"],
                "description": "Allows users to verify the setup of MFA for their account. Users need to provide the type of MFA used and the verification code to confirm the setup of MFA for their account.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "type": {
                                        "type": "string",
                                        "description": "The type of MFA being verified.",
                                        "enum": [
                                            "totp"
                                        ]
                                    },
                                    "code": {
                                        "type": "string",
                                        "description": "The verification code for the specified MFA type."
                                    }
                                },
                                "required": [
                                    "type",
                                    "code"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "MFA Setup Verification Successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/mfa/send-code": {
            "post": {
                "summary": "Send MFA Verification Code",
                "tags": ["Multi-Factor Authentication (MFA)"],
                "description": "Allows users, whether fully signed in or who have already initialized the sign-in process, to send an verification code for a MFA.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "type": {
                                        "type": "string",
                                        "enum": ["email"],
                                        "description": "The type of MFA method."
                                    },
                                    "token": {
                                        "type": "string",
                                        "format": "JWT",
                                        "description": "A JSON Web Token (JWT) provided to users who have initialized the sign-in process."
                                    }
                                },
                                "required": ["type", "token"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "MFA Verification Code Sent Successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/oauth2/authorize": {
            "post": {
                "summary": "Authorize Client for OAuth2",
                "tags": ["OAuth2"],
                "description": "This endpoint is used to authorize a client application for OAuth2. It allows users to grant permission to the client to access their resources by providing client ID, redirect URL, and requested scopes.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "type": "string",
                                        "format": "UUID",
                                        "description": "The unique identifier of the client application."
                                    },
                                    "redirect_url": {
                                        "type": "string",
                                        "format": "URL",
                                        "description": "The URL where the user will be redirected after authorization."
                                    },
                                    "scopes": {
                                        "type": "array",
                                        "description": "An array of scopes specifying the level of access requested by the client."
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Authorization",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "code": {
                                            "type": "string",
                                            "format": "UUID",
                                            "description": "Authorization code generated for the client."
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/oauth2/token": {
            "post": {
                "summary": "OAuth2 Token",
                "tags": ["OAuth2"],
                "description": "This endpoint is used to obtain OAuth2 tokens for different grant types, such as 'authorization_code', 'client_credentials', and 'refresh_token'. The response may vary based on the selected grant type.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "grant_type": {
                                        "type": "string",
                                        "description": "The type of grant being used (e.g., 'authorization_code', 'client_credentials', 'refresh_token').",
                                        "enum": [
                                            "authorization_code", 
                                            "client_credentials", 
                                            "refresh_token"
                                        ]
                                    },
                                        "client_id": {
                                        "type": "string",
                                        "format": "UUID",
                                        "description": "The unique identifier of the client application. Not required for 'refresh_token' grant."
                                    },
                                        "client_secret": {
                                        "type": "string",
                                        "description": "The client's secret key. Not required for 'refresh_token' grant."
                                    },
                                    "code": {
                                        "type": "string",
                                        "format": "JWT",
                                        "description": "The authorization code (required for 'authorization_code' grant)."
                                    },
                                    "refresh_token": {
                                        "type": "string",
                                        "format": "JWT",
                                        "description": "The refresh token (required for 'refresh_token' grant)."
                                    }
                                },
                                "required": ["grant_type"]
                            },
                            "examples": {
                                "authorization_code": {
                                    "value": {
                                        "grant_type": "authorization_code",
                                        "client_id": "your_client_id",
                                        "client_secret": "your_client_secret",
                                        "code": "your_authorization_code"
                                    }
                                },
                                "client_credentials": {
                                    "value": {
                                        "grant_type": "client_credentials",
                                        "client_id": "your_client_id",
                                        "client_secret": "your_client_secret"
                                    }
                                },
                                "refresh_token": {
                                    "value": {
                                        "grant_type": "refresh_token",
                                        "refresh_token": "your_refresh_token"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful OAuth2 Token Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "access_token": {
                                            "type": "string",
                                            "format": "JWT",
                                            "description": "The access token."
                                        },
                                        "token_type": {
                                            "type": "string",
                                            "description": "The type of token (e.g., 'bearer')."
                                        },
                                        "expires": {
                                            "type": "integer",
                                            "format": "UNIX",
                                            "description": "The duration in seconds for which the token is valid."
                                        },
                                        "refresh_token": {
                                            "type": "string",
                                            "format": "JWT",
                                            "description": "The refresh token (optional)."
                                        }
                                    },
                                    "required": ["access_token", "token_type", "expires"]
                                },
                                "examples": {
                                    "authorization_code": {
                                        "value": {
                                            "access_token": "your_access_token_auth_code",
                                            "token_type": "bearer",
                                            "expires": 3600,
                                            "refresh_token": "your_refresh_token_auth_code"
                                        }
                                    },
                                    "client_credentials": {
                                        "value": {
                                            "access_token": "your_access_token_client_creds",
                                            "token_type": "bearer",
                                            "expires": 3600
                                        }
                                    },
                                    "refresh_token": {
                                        "value": {
                                            "access_token": "your_access_token_refresh_token",
                                            "token_type": "bearer",
                                            "expires": 3600,
                                            "refresh_token": "your_refresh_token_refresh_token"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/oauth2/connections": {
            "get": {
                "summary": "Get OAuth2 Connections",
                "tags": ["OAuth2"],
                "description": "This endpoint allows users to retrieve OAuth2 connections associated with their account.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OAuth2 Connections Retrieved Successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "organization": {
                                                "type": "object",
                                                "properties": {
                                                    "id": {
                                                        "type": "integer",
                                                        "description": "The unique identifier of the organization."
                                                    },
                                                    "name": {
                                                        "type": "string",
                                                        "description": "The name of the organization."
                                                    },
                                                    "display_name": {
                                                        "type": "string",
                                                        "description": "The display name of the organization."
                                                    }
                                                }
                                            },
                                            "description": {
                                                "type": "string",
                                                "description": "The description of the OAuth2 application."
                                            },
                                            "homepage_url": {
                                                "type": "string",
                                                "format": "URL",
                                                "description": "The homepage URL of the OAuth2 application."
                                            },
                                            "client_id": {
                                                "type": "string",
                                                "format": "UUID",
                                                "description": "The client ID of the OAuth2 application."
                                            }
                                        }
                                    },
                                    "examples": [
                                        [
                                            {
                                                "organization": {
                                                    "id": 1,
                                                    "name": "Organization 1",
                                                    "display_name": "Org 1"
                                                },
                                                "description": "OAuth2 Connection 1",
                                                "homepage_url": "https://example.com/app1",
                                                "client_id": "client_id_1"
                                                },
                                                {
                                                "organization": {
                                                    "id": 2,
                                                    "name": "Organization 2",
                                                    "display_name": "Org 2"
                                                },
                                                "description": "OAuth2 Connection 2",
                                                "homepage_url": "https://example.com/app2",
                                                "client_id": "client_id_2"
                                            }
                                        ]
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/oauth2/connection": {
            "delete": {
                "summary": "Delete OAuth2 Connection",
                "tags": ["OAuth2"],
                "description": "This endpoint allows authenticated users to delete an OAuth2 connection associated with their account.",
                "security": [
                    {
                        "Auth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "type": "string",
                                        "format": "UUID",
                                        "description": "The client ID of the OAuth2 application to be deleted."
                                    }
                                },
                                "required": ["client_id"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OAuth2 Connection Deleted Successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/oauth2/revoke": {
            "delete": {
                "summary": "Revoke OAuth2 Connection",
                "tags": ["OAuth2"],
                "description": "This endpoint allows clients to revoke an OAuth2 connection associated with an 'authorization_code' grant type using a refresh token. When a connection is revoked, access to the associated account data is terminated.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "refresh_token": {
                                        "type": "string",
                                        "format": "JWT",
                                        "description": "The refresh token used to revoke the OAuth2 connection associated with an 'authorization_code' grant type."
                                    }
                                },
                                "required": ["refresh_token"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OAuth2 Connection Revoked Successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SuccessResponse"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
